<Catalog>
    <measure name="Avergae time to process a request" tags="">
        <query name="processTimeAvrg">SELECT AVG(REMARKS->"$.duration") FROM LAS2PEERMON.MESSAGE			WHERE EVENT = 'SERVICE_CUSTOM_MESSAGE_40'  AND SOURCE_AGENT = '$SERVICE$';</query>
        <visualization type="Value">
            <unit>ms</unit>
        </visualization>
    </measure>
    <measure name="Avergae process time per uri" tags="">
        <query name="processTimeAvgByUri">SELECT REMARKS->"$.url",AVG(REMARKS->"$.duration") FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'SERVICE_CUSTOM_MESSAGE_40'  GROUP BY REMARKS->"$.url"; </query>
        <visualization type="Chart">
            <chartType>BarChart</chartType>
            <nodeId>chartNode</nodeId>
            <title>chart title</title>
            <height>300</height>
            <width>300</width>
        </visualization>
    </measure>
    <measure name="Successful Service Requests Ratio" tags="">
        <query name="MessageReceived">        SELECT COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'MESSAGE_RECEIVED' AND SOURCE_AGENT = '$SERVICE$'        </query>
        <query name="SuccessResponses">        SELECT COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'RESPONSE_SENDING'  AND SOURCE_AGENT = '$SERVICE$'        </query>
        <visualization type="KPI">
            <operand name="SuccessResponses" index="0"/>
            <operator name="/" index="1"/>
            <operand name="MessageReceived" index="2"/>
        </visualization>
    </measure>
    <measure name="Number of unhandled exceptions" tags="">
        <query name="exceptionCount">			SELECT COUNT(*) FROM			LAS2PEERMON.MESSAGE			WHERE EVENT = 'SERVICE_CUSTOM_ERROR_1' AND SOURCE_AGENT = '$SERVICE$'        </query>
        <visualization type="Value">
            <unit/>
        </visualization>
    </measure>
    <measure name="Number of unsuccessfull menu retrievals" tags="">
        <query name="menuRetrieveFailures">			SELECT COUNT(*) FROM			LAS2PEERMON.MESSAGE			WHERE EVENT = 'SERVICE_CUSTOM_ERROR_2' AND SOURCE_AGENT = '$SERVICE$'        </query>
        <visualization type="Value">
            <unit/>
        </visualization>
    </measure>
    <measure name="Time spent on chat interactions per week (per user)" tags="">
        <query name="timeSpent">			SELECT sum(time),email FROM(                SELECT REMARKS-&gt;"$.time" as time, REMARKS-&gt;"$.email" as email FROM LAS2PEERMON.MESSAGE                 WHERE EVENT = 'SERVICE_CUSTOM_MESSAGE_41' AND SOURCE_AGENT = '$SERVICE$'                 GROUP BY REMARKS-&gt;"$.email", WEEK(time_stamp)            ) as T        </query>
        <visualization type="Value">
            <unit/>
        </visualization>
    </measure>
    <measure name="Ratio of chat requests" tags="">
        <query name="BotRequest">        SELECT COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'MESSAGE_RECEIVED' AND SOURCE_AGENT = '$SERVICE$' AND REMARKS-&gt;"$.msg" like "Botaction"        </query>
        <query name="AllRequests">        SELECT COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'MESSAGE_RECEIVED'  AND SOURCE_AGENT = '$SERVICE$'        </query>
        <visualization type="KPI">
            <operand name="BotRequest" index="0"/>
            <operator name="/" index="1"/>
            <operand name="AllRequests" index="2"/>
        </visualization>
    </measure>
    <measure name="Ratio of community application requests" tags="">
        <query name="BotRequest">        SELECT COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'MESSAGE_RECEIVED' AND SOURCE_AGENT = '$SERVICE$' AND REMARKS-&gt;"$.msg" like "Botaction"        </query>
        <query name="AllRequests">        SELECT COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'MESSAGE_RECEIVED'  AND SOURCE_AGENT = '$SERVICE$'        </query>
        <visualization type="KPI">
            <operand name="BotRequest" index="0"/>
            <operator name="/" index="1"/>
            <operand name="AllRequests" index="2"/>
        </visualization>
    </measure>
    <measure name="Distribution of requests" tags="">
        <query name="ReqDistro">       SELECT JSON_EXTRACT(REMARKS,"msg") as type, COUNT(*) FROM LAS2PEERMON.MESSAGE WHERE EVENT = 'MESSAGE_RECEIVED' GROUP BY JSON_EXTRACT(REMARKS,"msg");   </query>
        <visualization type="Chart">
            <chartType>PieChart</chartType>
            <nodeId>chartNode</nodeId>
            <title>Types of requests</title>
            <height>300</height>
            <width>300</width>
        </visualization>
    </measure>
    <measure name="Process durations over time" tags="">
        <query name="ProcDurations">        SELECT TIME_STAMP AS Time,        AVG(JSON_EXTRACT(REMARKS,"$.duration")) FROM			LAS2PEERMON.MESSAGE			WHERE EVENT = 'SERVICE_CUSTOM_MESSAGE_40'  AND SOURCE_AGENT = '$SERVICE$'            GROUP BY Time        </query>
        <visualization type="Chart">
            <chartType>LineChart</chartType>
            <nodeId>chartNode</nodeId>
            <title>Average process durations</title>
            <height>300</height>
            <width>300</width>
        </visualization>
    </measure>
    <measure name="Average time to submit a review" tags="">
        <query name="AvgTimeToReview">			SELECT avg(REMARKS-&gt;"$.time")/1000 as time FROM LAS2PEERMON.MESSAGE 	        WHERE EVENT = 'SERVICE_CUSTOM_MESSAGE_41' AND REMARKS-&gt;"$.task" = "review"        </query>
        <visualization type="Value">
            <unit>s</unit>
        </visualization>
    </measure>
</Catalog>